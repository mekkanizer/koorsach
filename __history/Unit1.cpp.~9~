//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit1.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;

String str_rand(int l) {
	srand(time(NULL));
	int i;
	String str="";
	switch (l) {
		case 1: // plane type
			switch (rand()%5) {
				case 0: str = "700"; break; //"BOING"
				case 1: str = "500"; break; //"AIRBUS"
				case 2: str = "40"; break; //"YAK"
				case 3: str = "300"; break; //"TU"
				case 4: str = "80"; break; //"IL"
			}
		break;

		case 2: //date
			str = str + IntToStr(rand()%28+1) + "." + IntToStr(rand()%12+1)\
			+ "." + IntToStr(rand()%30+1960);
		break;

		case 3: //time
			str = str + IntToStr(rand()%24) + ":" + IntToStr(rand()%60);
		break;

		//name;surname;middlename;destination
		case 4:case 8:case 9:case 10:
			str += (char)(rand()%26+65);
			for (i=1; i<l; i++)
				str += (char)(rand()%26+97);
		break;

		case 5: //ser_pasp; n pasp;
			for (i=0; i<l; i++)
				str += (char)(rand()%10+48);
		break;

		case 6: // t_bilet
			switch (rand()%3) {
				case 0: str = "econom"; break;
				case 1: str = "busine"; break;
				case 2: str = "first"; break;
			}
		break;

		case 7: //sex
			rand()%2 ? str = "m" : str = "f";
		break;
	}
	return str;
}
//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------

void __fastcall TForm1::RadioButton1Click(TObject *Sender)
{
	ADOQuery1->Active = false;
	ADOQuery1->SQL->Text = "SELECT * FROM Билеты";
	ADOQuery1->Active = true;
}
//---------------------------------------------------------------------------
void __fastcall TForm1::RadioButton2Click(TObject *Sender)
{
	ADOQuery1->Active = false;
	ADOQuery1->SQL->Text = "SELECT * FROM Пассажиры";
	ADOQuery1->Active = true;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::RadioButton3Click(TObject *Sender)
{
	ADOQuery1->Active = false;
	ADOQuery1->SQL->Text = "SELECT * FROM Рейсы";
	ADOQuery1->Active = true;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::RadioButton4Click(TObject *Sender)
{
	ADOQuery1->Active = false;
	ADOQuery1->SQL->Text = "SELECT * FROM Самолеты";
	ADOQuery1->Active = true;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::add_randClick(TObject *Sender)
{
	static int n_pl=0; // plane number
	static int n_seat=0; // seat number
	static int n_fl=0; // flight number
	static int n_pas=0; // passenger number
	static int n_t=0; // ticket number

	n_pl++;
	n_seat++;
	n_fl++;
	n_pas++;
	n_t++;

	// make planes table active
	ADOQuery1->Active = false;
	ADOQuery1->SQL->Text = "SELECT * FROM Самолеты";
	ADOQuery1->Active = true;

	n_seat = str_rand(1).ToInt();
	ADOQuery1->Append();
	ADOQuery1->Edit();
	ADOQuery1->FieldByName("Кол_во_мест")->AsInteger = n_seat;
	switch (n_seat) {
		case 700: ADOQuery1->FieldByName("Тип_самолета")->AsString = "BOING"; break;
		case 500: ADOQuery1->FieldByName("Тип_самолета")->AsString = "AIRBUS"; break;
		case 40: ADOQuery1->FieldByName("Тип_самолета")->AsString = "YAK"; break;
		case 300: ADOQuery1->FieldByName("Тип_самолета")->AsString = "TU"; break;
		case 80: ADOQuery1->FieldByName("Тип_самолета")->AsString = "IL"; break;
	}
	ADOQuery1->FieldByName("Номер_самолета")->AsInteger = n_pl;
	ADOQuery1->Post();

	// make planes table active
	ADOQuery1->Active = false;
	ADOQuery1->SQL->Text = "SELECT * FROM Рейсы";
	ADOQuery1->Active = true;

	ADOQuery1->Append();
	ADOQuery1->Edit();
	ADOQuery1->FieldByName("Дата_вылета")->AsString = str_rand(2);
	ADOQuery1->FieldByName("Дата_прилета")->AsString = str_rand(2);
	ADOQuery1->FieldByName("Время_вылета")->AsString = str_rand(3);
	ADOQuery1->FieldByName("Время_прилета")->AsString = str_rand(3);
	ADOQuery1->FieldByName("Пункт_отправления")->AsString = str_rand(10);
	ADOQuery1->FieldByName("Пункт_назначения")->AsString = str_rand(10);
	ADOQuery1->FieldByName("Номер_самолета")->AsInteger = n_pl;
	ADOQuery1->FieldByName("Номер_рейса")->AsInteger = n_fl;
	ADOQuery1->Post();

	// make passengers table active
	ADOQuery1->Active = false;
	ADOQuery1->SQL->Text = "SELECT * FROM Пассажиры";
	ADOQuery1->Active = true;

	ADOQuery1->Append();
	ADOQuery1->Edit();
	ADOQuery1->FieldByName("Имя")->AsString = str_rand(4);
	ADOQuery1->FieldByName("Фамилия")->AsString = str_rand(8);
	ADOQuery1->FieldByName("Отчество")->AsString = str_rand(9);
	ADOQuery1->FieldByName("Дата_Рождения")->AsString = str_rand(2);
	ADOQuery1->FieldByName("Пол")->AsString = str_rand(7);
	ADOQuery1->FieldByName("Серия_паспорта")->AsInteger = str_rand(5).ToInt();
	ADOQuery1->FieldByName("Номер_паспорта")->AsInteger = str_rand(5).ToInt();
	ADOQuery1->FieldByName("Номер_пассажира")->AsInteger = n_pas;
	ADOQuery1->Post();

	// make tickets table active
	ADOQuery1->Active = false;
	ADOQuery1->SQL->Text = "SELECT * FROM Билеты";
	ADOQuery1->Active = true;

	ADOQuery1->Append();
	ADOQuery1->Edit();
	ADOQuery1->FieldByName("Тип_билета")->AsString = str_rand(6);
	ADOQuery1->FieldByName("Номер_места")->AsInteger = rand()%n_seat + 1;
	ADOQuery1->FieldByName("Номер_пассажира")->AsInteger = n_pas;
	ADOQuery1->FieldByName("Номер_рейса")->AsInteger = n_fl;
	ADOQuery1->FieldByName("Номер_билета")->AsInteger = n_t;
	ADOQuery1->Post();
}
//---------------------------------------------------------------------------
